<script lang="ts">
	import { setIcon } from "obsidian";
	import { onMount } from "svelte";
	import { getSvgData } from "../services/get-svg-data";

	export let ariaLabel = "";
	export let iconId = "";
	export let xs = false;

	let ref: HTMLElement | null = null;

	// Use onMount to ensure the element is available in the DOM
	onMount(() => {
		if (!ref) return;
		if (iconId === "ellipsis-vertical") return;
		if (iconId === "file-pdf") return;
		setIcon(ref, iconId);

		// const icon = ref.querySelector("svg");

		// if (xs && icon) {
		// 	icon.style.setProperty("width", "var(--icon-xs)");
		// 	icon.style.setProperty("height", "var(--icon-xs)");
		// }
	});

	$: svgData = getSvgData(iconId);

	$: className = `vault-explorer-icon ${xs ? "vault-explorer-icon--xs" : "vault-explorer-icon--md"}`;
</script>

<div class={className} aria-label={ariaLabel} bind:this={ref}>
	{@html svgData}
</div>

<style>
	.vault-explorer-icon {
		cursor: var(--cursor);
		color: var(--icon-color);
		opacity: var(--icon-opacity);
	}

	.vault-explorer-icon--md {
		width: var(--icon-m);
		height: var(--icon-m);
	}

	.vault-explorer-icon--xs {
		width: var(--icon-xs);
		height: var(--icon-xs);
	}
</style>
